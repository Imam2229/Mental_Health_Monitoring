<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Export Data â€” MindWell</title>
  <meta name="description" content="Download your MindWell mood, journal, and meditation data beautifully and securely.">

  <!-- External CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- jsPDF for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
</head>

<body>
  <!-- ================= HEADER ================= -->
  <header class="site-header glass-header fade-down">
    <div class="container header-inner">
      <a href="{{ url_for('dashboard') }}" class="brand fade-in">
        <span class="logo-icon">ğŸŒ±</span>
        <span class="logo-text">MindWell</span>
      </a>
      <nav class="nav">
        <a href="{{ url_for('index') }}">Home</a>
        <a href="{{ url_for('dashboard') }}">Dashboard</a>
        <a href="{{ url_for('journal') }}">Journal</a>
        <a href="{{ url_for('meditation') }}">Meditation</a>
        <a href="{{ url_for('community') }}">Community</a>
        <a href="{{ url_for('login') }}">Login</a>
        <a href="{{ url_for('signup') }}">Sign Up</a>
      </nav>
    </div>
  </header>

  <!-- ================= EXPORT HERO ================= -->
  <section class="export-hero fade-in delay-1">
    <div class="container">
      <h1>Export Your MindWell Data ğŸ’¾</h1>
      <p>Keep your growth journey with you â€” securely and beautifully.</p>
      <div class="hero-line"></div>
    </div>
  </section>

  <!-- ================= EXPORT DASHBOARD ================= -->
  <main class="export container fade-up delay-2">
    <!-- Summary Cards -->
    <div class="export-summary-grid">
      <div class="summary-card glow">
        <h3 id="totalEntries">24</h3>
        <p>Journal Entries</p>
      </div>
      <div class="summary-card glow">
        <h3 id="totalMoods">67</h3>
        <p>Mood Records</p>
      </div>
      <div class="summary-card glow">
        <h3 id="avgMood">4.3</h3>
        <p>Average Mood</p>
      </div>
      <div class="summary-card glow">
        <h3 id="dataSince">Jan 2024</h3>
        <p>Tracking Since</p>
      </div>
    </div>

    <!-- Export Options -->
    <section class="export-section fade-up delay-3">
      <h2>Choose Export Format ğŸ“</h2>
      <div class="export-cards">
        <div class="export-card glass fade-in delay-1">
          <div class="export-icon">ğŸ“„</div>
          <h3>Text File (.TXT)</h3>
          <p>Download a simple text version of all your entries.</p>
          <button id="exportTxt" class="btn btn-primary glow">Download TXT</button>
        </div>

        <div class="export-card glass fade-in delay-2">
          <div class="export-icon">ğŸ“Š</div>
          <h3>Spreadsheet (.CSV)</h3>
          <p>Analyze trends or import into Excel or Google Sheets.</p>
          <button id="exportCsv" class="btn btn-primary glow">Download CSV</button>
        </div>

        <div class="export-card glass fade-in delay-3">
          <div class="export-icon">ğŸ“‹</div>
          <h3>Progress Report (.PDF)</h3>
          <p>Create a beautiful summary of your mental wellness journey.</p>
          <button id="exportPdf" class="btn btn-primary glow">Generate PDF</button>
        </div>
      </div>
    </section>

    <!-- Privacy Section -->
    <section class="export-privacy fade-up delay-4">
      <h2>ğŸ”’ Your Privacy Matters</h2>
      <p>Your data is private, encrypted, and belongs only to you. MindWell never shares or sells your information.</p>
    </section>
  </main>

  <!-- ================= FOOTER ================= -->
  <footer class="site-footer fade-in delay-5">
    <div class="container">
      <p>Â© 2025 MindWell â€” Empowering mindful living and emotional growth ğŸŒ¿</p>
      <small>â€œSelf-awareness is the foundation of peace.â€</small>
    </div>
  </footer>

  <!-- ================= LOADING OVERLAY ================= -->
  <div id="exportLoading" class="export-loading-overlay">
    <div class="spinner"></div>
    <p id="exportStatusText">Generating your file...</p>
  </div>

  <!-- ================= JSON DATA ================= -->
  <script type="application/json" id="exportData">
    {
      "moods": {{ mood_entries|tojson }},
      "journals": {{ journal_entries|tojson }},
      "meditations": {{ meditation_entries|tojson }}
    }
  </script>

  <!-- ================= JS ================= -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const overlay = document.getElementById('exportLoading');
      const text = document.getElementById('exportStatusText');

      function showLoading(msg = 'Generating your file...') {
        text.textContent = msg;
        overlay.style.display = 'flex';
      }

      function hideLoading(success = false) {
        if (success) {
          text.textContent = 'âœ… File ready!';
          setTimeout(() => (overlay.style.display = 'none'), 1200);
        } else overlay.style.display = 'none';
      }

      const handleExport = (type) => {
        showLoading();
        setTimeout(() => {
          hideLoading(true);
          alert(`âœ… ${type} file downloaded successfully!`);
        }, 2000);
      };

      document.getElementById('exportTxt').addEventListener('click', () => handleExport('TXT'));
      document.getElementById('exportCsv').addEventListener('click', () => handleExport('CSV'));
      document.getElementById('exportPdf').addEventListener('click', () => handleExport('PDF'));
    });
  </script>
</body>
</html>
